version: '3.8'
services:
  libretranslate:
    image: libretranslate/libretranslate:latest
    container_name: libretranslate
    ports:
      - "5000:5000"
    environment:
      - PORT=5000
      - LT_UPDATE_MODELS=true
      # Load all available language models (removed LT_LOAD_ONLY restriction)
      # Keep translation strictly single-threaded to avoid known crashes/500s
      # in Argos/Stanza under concurrency. Tune up only after stability.
      - LT_THREADS=1
      - OMP_NUM_THREADS=1
      - OPENBLAS_NUM_THREADS=1
      - MKL_NUM_THREADS=1
      - NUMEXPR_NUM_THREADS=1
      - TOKENIZERS_PARALLELISM=false
    restart: unless-stopped